<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport" />
        <title>Login COP4331</title>
        <script src="js/jquery-3.6.0.js" type="text/javascript" ></script>
        <script src="js/jquery-3.6.0.min.js" type="text/javascript" ></script>
        <link rel="icon" href="data:,">
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>

        <style>
            .divider:after,
            .divider:before {
                content: "";
                flex: 1;
                height: 1px;
                background: #eee;
            }
            .h-custom {
                height: calc(100% - 73px);
            }
        </style>
    </head>

    <body class="vh-100">

        <div class="container-fluid h-custom">
            <div class="row d-flex justify-content-center align-items-center h-100">

                <div class="col-md-9 col-lg-6 col-xl-5 justify-content-center">
                    <img src="images/ucf-logo-square3.png" class="rounded mx-auto d-block">
                </div>

                <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
                    <form>
                        <div class="d-flex justify-content-center">
                            <p class="lead fw-bold mb-0 me-3">PERSONAL CONTACT MANAGER (PCM)</p>
                        </div>
                        <div class="d-flex justify-content-center">
                            <p class="lead font-weight-light mb-0 me-3">COP4331</p>
                        </div>

                        <div class="divider d-flex align-items-center my-4">
                            <p class="text-center fw-bold mx-3 mb-0"></p>
                        </div>

                        <!-- Email input -->
                        <div class="form-outline mb-4">
                            <input type="email" id="loginName" class="form-control form-control-lg" placeholder="Enter a valid email address" />
                            <label class="form-label">Email address</label>
                        </div>

                        <!-- Password input -->
                        <div class="form-outline mb-3">
                            <input type="password" id="userPassword" class="form-control form-control-lg" placeholder="Enter password" />
                            <label class="form-label">Password</label>
                        </div>

                        <div class="mt-4 pt-2" style="text-align: center">
                            <button id="submitButton" type="button" class="btn btn-primary btn-lg" style="padding: 0.5rem 3rem">Login</button>
                            <button id="signupButton" type="button" class="btn btn-primary btn-lg">New user? Register here</button>
                        </div>

                        <div class="divider d-flex align-items-center my-4">
                            <p id="errorMessage" class="text-center fw-bold mx-3 mb-0"></p>
                        </div>

                    </form>
                </div>
            </div>
        </div>

        <script>

            $(document).ready(function() {

                $("#submitButton").focusout( function() {
                    $("#errorMessage").text("");
                });

                $("#submitButton").click( function() {

                    var userName = $("#loginName").val();
                    var userPass = $("#userPassword").val();
                    var endPoint = "http://pcm.sudonet.cc/LAMPAPI/login.php";
                    var userIsValid = false;

                    if (userName && userPass) {

                        var request = $.ajax({
                            method: "POST",
                            url: endPoint,
                            data: JSON.stringify({ login: userName, password: userPass })
                        })
                        .done(function( response ) {
                            console.log( "Data1: " + JSON.stringify(response) );
                            var data = $.parseJSON(response);
                            if (data.id > 0 ) {
                                userIsValid = true;
                            };
                        })
                        .fail(function() {
                            alert( "error" );
                        })
                        .always(function() {

                        });







                        if (userIsValid) {
                            $("body").load("contacts.html");
                        } else {
                            $("#errorMessage").text("No Records Found");
                        };

                    } else {
                        $("#errorMessage").text("Please enter Email and Password");
                    };
                })
            });

            function requestAPI(endPoint, userName, userPass) {
                var response;
                var request = $.ajax({
                    method: "POST",
                    url: endPoint,
                    async: false,
                    data: JSON.stringify({ login: userName, password: userPass })
                })
                .done(function( response ) {
                    console.log( "Data1: " + JSON.stringify(response) );
                })
                .fail(function() {
                    alert( "error" );
                })
                .always(function() {
                    return response;
                });

            };


        </script>
    </body>
</html>
